{% schema %}
{
  "name": "Product information",
  "blocks": [
    {
      "type": "title",
      "name": "Title",
      "limit": 1
    },
    {
      "type": "text",
      "name": "Vendor",
      "settings": [
        {
          "type": "text",
          "id": "text",
          "label": "Text"
        },
        {
          "type": "select",
          "id": "text_style",
          "label": "Text style",
          "options": [
            {
              "value": "uppercase",
              "label": "Uppercase"
            },
            {
              "value": "lowercase",
              "label": "Lowercase"
            },
            {
              "value": "normal",
              "label": "Normal"
            }
          ],
          "default": "uppercase"
        }
      ]
    },
    {
      "type": "price",
      "name": "Price",
      "limit": 1
    },
    {
      "type": "variant_picker",
      "name": "Variant picker",
      "limit": 1,
      "settings": [
        {
          "type": "select",
          "id": "picker_type",
          "options": [
            {
              "value": "dropdown",
              "label": "Dropdown"
            },
            {
              "value": "button",
              "label": "Button"
            }
          ],
          "default": "button",
          "label": "Picker type"
        }
      ]
    },
    {
      "type": "quantity_selector",
      "name": "Quantity selector",
      "limit": 1
    },
    {
      "type": "buy_buttons",
      "name": "Buy buttons",
      "limit": 1
    },
    {
      "type": "description",
      "name": "Description",
      "limit": 1
    },
    {
      "type": "complementary_products",
      "name": "Complementary products",
      "settings": [
        {
          "type": "paragraph",
          "content": "Show complementary products"
        }
      ]
    }
  ],
  "settings": [
    {
      "type": "checkbox",
      "id": "show_share_buttons",
      "label": "Show social sharing buttons",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_sticky_info",
      "label": "Enable sticky info on mobile",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_video_looping",
      "label": "Enable video looping",
      "default": false
    }
  ]
}
{% endschema %}

<main class="container mx-auto px-4 md:px-8 py-6">
  <div class="flex flex-col md:flex-row gap-8">
    <!-- Product Images -->
    <div class="md:w-1/2">
      <div class="bg-white rounded-lg shadow-sm overflow-hidden">
        <div id="mainImage" class="h-80 md:h-96 flex items-center justify-center p-4">
          {%- if product.featured_media -%}
            {{ product.featured_media | image_url: width: 800 | image_tag:
              loading: 'lazy',
              width: 800,
              height: 800,
              class: 'max-h-full max-w-full object-contain',
              id: 'featured-image'
            }}
          {%- endif -%}
        </div>
        <div class="flex overflow-x-auto p-4 gap-2">
          {%- for media in product.media -%}
            <div class="product-image-thumbnail w-20 h-20 flex-shrink-0 border border-gray-200 rounded cursor-pointer hover:border-black" 
                
                 data-media-id="{{ media.id }}">
              {{ media | image_url: width: 160 | image_tag:
                loading: 'lazy',
                width: 80,
                height: 80,
                class: 'w-full h-full object-cover'
              }}
            </div>
          {%- endfor -%}
        </div>
      </div>
    </div>

    <!-- Product Info -->
    <div class="md:w-1/2">
      <div class="bg-white rounded-lg shadow-sm p-6">
        {%- for block in section.blocks -%}
          {%- case block.type -%}
            {%- when 'title' -%}
              <h1 class="text-3xl font-bold mb-2">{{ product.title }}</h1>
            
            {%- when 'price' -%}
              <div class="mb-6" data-price-area>
                {% render 'price', product: product, pdp: true %}
              </div>

            {%- when 'variant_picker' -%}
              {%- unless product.has_only_default_variant -%}
                <div data-url="{{ product.url }}" data-section="{{ section.id }}">
                  {%- for option in product.options_with_values -%}
                    <div class="mb-4 variant-list">
                      <label class="block text-sm font-medium mb-2">{{ option.name }}</label>
                      <div class="flex flex-wrap gap-2">
                        {%- for value in option.values -%}
                          <div class="custom-radio">
                            <input type="radio"
                              name="{{ option.name }}"
                              id="{{ option.name }}-{{ value }}"
                              value="{{ value }}"
                              class="custom-option hidden"
                              {% if option.selected_value == value %}checked{% endif %}>
                            <label for="{{ option.name }}-{{ value }}" 
                              class="px-4 py-2 border border-gray-300 rounded cursor-pointer hover:bg-gray-50">
                              {{ value }}
                            </label>
                          </div>
                        {%- endfor -%}
                      </div>
                    </div>
                  {%- endfor -%}
                </div>

              {%- endunless -%}
              

            {%- when 'buy_buttons' -%}
              <div class="cta-area mt-6 border-t border-gray-200 pt-3">
                <div class="text-red-600 text-sm mb-2 product-message-error hidden"><p></p></div>
  
                <div class="flex items-center gap-4">
                  <div class="flex border border-gray-300 rounded">
                    <button class="px-3 py-3 bg-gray-100 hover:bg-gray-200" data-decrease-quantity>-</button>
                    <input type="number" 
                      name="quantity" 
                      id="Quantity-{{ section.id }}" 
                      value="1" 
                      min="1"
                      class="w-12 text-center border-x border-gray-300">
                    <button class="px-3 py-3 bg-gray-100 hover:bg-gray-200" data-increase-quantity>+</button>
                  </div>
  
                  <form method="post" action="/cart/add" form-add-to-cart>
                    <input type="hidden" name="id" value="{{ product.selected_or_first_available_variant.id }}">
                    <button type="submit" 
                      class="flex-grow bg-black text-white py-3 px-6 rounded hover:bg-gray-800 transition flex items-center justify-center
                      {% if product.selected_or_first_available_variant.available == false %}opacity-50 cursor-not-allowed{% endif %}"
                      {% if product.selected_or_first_available_variant.available == false %}disabled{% endif %}
                        data-add-to-cart data-loading-white
                    >
                      <i class="fas fa-shopping-bag mr-2"></i>
                      {%- if product.selected_or_first_available_variant.available -%}
                        {{ 'products.product.add_to_cart' | t }}
                      {%- else -%}
                        {{ 'products.product.sold_out' | t }}
                      {%- endif -%}
                    </button>
                  </form>
                </div>

              </div>
              

            {%- when 'description' -%}
              <div class="mt-6 border-t border-gray-200 pt-6">
                <div class="prose prose-sm">
                  {{ product.description }}
                </div>
              </div>
          {%- endcase -%}
        {%- endfor -%}
      </div>
    </div>
  </div>
</main>

{%- assign section_id = section.id -%}

<script>
    window.currentSectionId = '{{ section_id }}';
    window.currentProduct = {
      "title": "{{ product.title | escape }}",
      "id": "{{ product.id }}",
      "handle": "{{ product.handle }}",
      "available": {{ product.available | json }},
      "variants": {{ product.variants | json }},
      "options": {{ product.options | json }},
      "media": {{ product.media | json }},
    };
</script>
