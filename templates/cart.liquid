<div class="container mx-auto px-4 py-8">
  {% if cart.item_count > 0 %}
    <h1 class="text-3xl font-bold text-center mb-8">Seu Carrinho</h1>
    <form action="{{ routes.cart_url }}" method="post" novalidate class="cart-form">
      <div class="flex flex-col lg:flex-row gap-8">
        <!-- Cart Items -->
        <div class="lg:w-2/3">
          <div class="border-b pb-4 mb-4 hidden md:flex">
            <div class="w-1/2 font-semibold">Produto</div>
            <div class="w-1/4 font-semibold text-center">Quantidade</div>
            <div class="w-1/4 font-semibold text-right">Total</div>
          </div>

          {% for item in cart.items %}
            <div class="flex flex-col md:flex-row items-center border-b py-4" data-line="{{ forloop.index }}">
              <!-- Product Info -->
              <div class="w-full md:w-1/2 flex items-center mb-4 md:mb-0">
                <a href="{{ item.url }}" class="mr-4">
                  <img src="{{ item.image | image_url: width: 100 }}" alt="{{ item.image.alt | escape }}" class="rounded-md w-20 h-20 object-cover" width="80" height="80">
                </a>
                <div>
                  <a href="{{ item.url }}" class="font-semibold hover:underline">{{ item.product.title }}</a>
                  {% if item.variant.title != 'Default Title' %}
                    <p class="text-sm text-gray-600">{{ item.variant.title }}</p>
                  {% endif %}
                  <p class="text-sm text-gray-600">{{ item.final_price | money }}</p>
                  <a href="{{ routes.cart_change_url }}?line={{ forloop.index }}&quantity=0" class="text-red-500 hover:underline text-sm mt-1 block">Remover</a>
                </div>
              </div>

              <!-- Quantity -->
              <div class="w-full md:w-1/4 flex items-center justify-center mb-4 md:mb-0">
                <div class="flex items-center border rounded-md">
                  <button type="button" class="quantity-btn p-2" data-action="decrement">-</button>
                  <input type="number" name="updates[]" value="{{ item.quantity }}" min="1" class="w-12 text-center border-l border-r" data-line="{{ forloop.index }}">
                  <button type="button" class="quantity-btn p-2" data-action="increment">+</button>
                </div>
              </div>

              <!-- Total Price -->
              <div class="w-full md:w-1/4 text-right font-semibold">
                {{ item.final_line_price | money }}
              </div>
            </div>
          {% endfor %}
          
          <div class="flex justify-between items-center mt-4">
            <a href="{{ routes.all_products_collection_url }}" class="text-blue-500 hover:underline">&larr; Continuar comprando</a>
            <button type="submit" name="update" class="px-4 py-2 border rounded-md hover:bg-gray-100">Atualizar Carrinho</button>
          </div>
        </div>

        <!-- Cart Summary -->
        <div class="lg:w-1/3">
          <div class="bg-gray-50 p-6 rounded-lg shadow-md">
            <h2 class="text-2xl font-bold mb-4">Resumo do Pedido</h2>
            <div class="flex justify-between mb-2">
              <span>Subtotal</span>
              <span class="font-semibold">{{ cart.total_price | money }}</span>
            </div>
            <p class="text-sm text-gray-500 mb-4">Frete e impostos calculados no checkout.</p>
            <button type="submit" name="checkout" class="w-full bg-black text-white py-3 rounded-md font-bold hover:bg-gray-800 transition-colors">
              Finalizar Compra
            </button>
          </div>
        </div>
      </div>
    </form>
  {% else %}
    <div class="text-center py-20">
      <h1 class="text-3xl font-bold mb-4">Seu carrinho está vazio</h1>
      <p class="mb-8">Parece que você ainda não adicionou nada. Que tal explorar nossos produtos?</p>
      <a href="{{ routes.all_products_collection_url }}" class="bg-black text-white py-3 px-6 rounded-md font-bold hover:bg-gray-800 transition-colors">
        Ver produtos
      </a>
    </div>
  {% endif %}
</div>
